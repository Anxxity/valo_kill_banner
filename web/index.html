<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kill Notifications</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        background: transparent;
        overflow: hidden;
      }

      #kill-notification {
        position: fixed;
        top: 90%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 30%;
        height: 30%;
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 9999;
      }

      #kill-notification.active {
        display: flex;
        animation: fadeIn 0.3s ease-in;
      }

      #kill-notification.fade-out {
        animation: fadeOut 0.5s ease-out forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }

      @keyframes screenFlash {
        0% {
          background-color: transparent;
        }
        50% {
          background-color: rgba(255, 255, 255, 0.3);
        }
        100% {
          background-color: transparent;
        }
      }

      body.flash {
        animation: screenFlash 0.4s ease-out;
      }

      video {
        width: 100%;
        height: 100%;
        object-fit: contain;
        background: transparent;
        animation: scaleIn 0.3s ease-out;
      }

      @keyframes scaleIn {
        from {
          transform: scale(0.95);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      audio {
        display: none;
      }


    </style>
  </head>
  <body>
    <div id="kill-notification">
      <video id="kill-video" autoplay muted playsinline></video>
      <audio id="kill-audio" autoplay playsinline></audio>
    </div>

    <script>
      const killConfig = {
        1: { video: 'vids/1-kill-notif.webm', audio: 'sounds/1-kill-notif.mp3' },
        2: { video: 'vids/2-kill-notif.webm', audio: 'sounds/2-kill-notif.mp3' },
        3: { video: 'vids/3-kill-notif.webm', audio: 'sounds/3-kill-notif.mp3' },
        4: { video: 'vids/4-kill-notif.webm', audio: 'sounds/4-kill-notif.mp3' },
        5: { video: 'vids/5-kill-notif.webm', audio: 'sounds/5-kill-notif.mp3' },
        6: { video: 'vids/6-kill-notif.webm', audio: 'sounds/6-kill-notif.mp3' },
      };

      const videoElement = document.getElementById('kill-video');
      const audioElement = document.getElementById('kill-audio');
      const notificationContainer = document.getElementById('kill-notification');

      function playKillNotification(killCount) {
   const config = killCount > 6 ? killConfig[6] : killConfig[killCount];

        if (!config) {
          console.error('No config found for kill count:', killCount);
          return;
        }

        videoElement.src = config.video;
        audioElement.src = config.audio;
        notificationContainer.classList.remove('fade-out');
        notificationContainer.classList.add('active');

        document.body.classList.remove('flash');
        setTimeout(() => {
          document.body.classList.add('flash');
        }, 10);

        videoElement.currentTime = 0;
        audioElement.currentTime = 0;

        const videoPlayPromise = videoElement.play();
        const audioPlayPromise = audioElement.play();

        if (videoPlayPromise !== undefined) {
          videoPlayPromise
            .then(() => {
              console.log('Video playing successfully');
            })
            .catch((error) => {
              console.error('Failed to play video:', error);
            });
        }

        if (audioPlayPromise !== undefined) {
          audioPlayPromise
            .then(() => {
              console.log('Audio playing successfully');
            })
            .catch((error) => {
              console.error('Failed to play audio:', error);
            });
        }

        videoElement.onended = () => {
          notificationContainer.classList.add('fade-out');
          setTimeout(() => {
            notificationContainer.classList.remove('active');
          }, 500);
        };

        videoElement.onloadedmetadata = () => {
          setTimeout(() => {
            if (notificationContainer.classList.contains('active')) {
              notificationContainer.classList.add('fade-out');
              setTimeout(() => {
                notificationContainer.classList.remove('active');
              }, 500);
            }
          }, (videoElement.duration + 0.5) * 1000);
        };
      }

      window.addEventListener('message', (event) => {
        const data = event.data;

        if (data.type === 'playerKill') {
          const killStreak = data.killStreak || 1;
          console.log(`Kill notification triggered: Kill ${killStreak}`);
          playKillNotification(killStreak);
        }
      });
    </script>
  </body>
</html>
